## QA Results (2025-10-30)

**Review Summary:**

- Codebase implements presence/availability state management and backend integration with Microsoft Teams via Graph API.
- Admin and user queries by date are supported.
- No dedicated automated tests found for availability/presence features; existing tests do not cover this story.

**Testability:**

- Manual verification required; automated test coverage is insufficient.

**Risks:**

- Increased risk of regression and undetected bugs due to lack of automated tests.

**Gate Decision:**

- CONCERNS: Functional requirements are met, but automated test coverage is missing. Recommend adding/expanding tests for all acceptance criteria before release.

# Story 07.01: Manage User Availability (Signin/Signoff & AFK)

- **Status**: Approved
- **Epic**: User Availability & Presence

## Story

**As a** user,
**I want** to manage my daily availability (signin, signoff, AFK, back) from the dashboard,
**So that** my presence and status are accurately reflected in the system and in Microsoft Teams.

## Acceptance Criteria

1. A new "Availability" section is visible on the user dashboard.

2. Users see "Signin" and "AFK" buttons:

   - "Signin" button starts the day, records signin time, and changes to "Signoff."
   - "AFK" button allows users to set an ETA (default 1 hour, customizable), changes to "Back" when active.
   - "Back" button resets presence/status.

3. Each action (Signin, AFK, Back, Signoff) sends a request to the backend:

   - Backend updates Teams availability and status message via Graph API.
   - All events are stored in the database.

4. Admins see an "Availability" button in their dashboard:

   - Can view todayâ€™s availability records for all users.
   - Can select a date to view historical records.

5. All availability events (signin, afk, back, signoff) are logged and retrievable by date.

## Tasks / Subtasks

- [x] **Frontend:**
  - [x] Add "Availability" section to dashboard for all users.
  - [x] Implement "Signin", "Signoff", "AFK", and "Back" button logic and UI states.
  - [x] Allow users to set and edit AFK ETA (default 1 hour).
  - [x] Display current status and times for each event.
  - [x] Admin dashboard: add "Availability" button and date selector to view records.
- [x] **Backend:**
  - [x] Create API endpoints for availability events (signin, signoff, afk, back).
  - [x] Integrate with Microsoft Graph API to update Teams presence/status.
  - [x] Store all events in the database and allow querying by date/user.
  - [x] Admin endpoint to retrieve availability records for any date.

## Dev Notes

## QA Results (2025-10-30)

**Review Summary:**

- Codebase implements presence/availability state management and backend integration with Microsoft Teams via Graph API.
- Admin and user queries by date are supported.
- No dedicated automated tests found for availability/presence features; existing tests do not cover this story.

**Testability:**

- Manual verification required; automated test coverage is insufficient.

**Risks:**

- Increased risk of regression and undetected bugs due to lack of automated tests.

**Gate Decision:**

- CONCERNS: Functional requirements are met, but automated test coverage is missing. Recommend adding/expanding tests for all acceptance criteria before release.
