# Story 3.3: Manage Bookings

- **Status**: Draft
- **Epic**: Core Booking Functionality

## Story

**As an** employee,
**I want** to view and cancel my bookings,
**so that** I can manage my reservations.

## Acceptance Criteria

1. The user can see a list of their upcoming bookings.
2. Each booking in the list displays the date, duration, and other relevant details.
3. The user has the option to cancel any of their upcoming bookings.
4. When a booking is canceled, it is removed from the user's list and the seat becomes available again.
5. The user cannot cancel past bookings.

## Tasks / Subtasks

- [x] **Frontend:**
  - [x] Create a new component to display the user's bookings.
  - [x] Fetch the user's bookings from the backend and display them.
  - [x] Add a "Cancel" button to each booking.
  - [x] Implement the logic to call the delete endpoint when the "Cancel" button is clicked.
  - [x] After a successful cancellation, the booking list and the availability for that date should be updated.
- [x] **Backend:**
  - [x] Create an API endpoint `GET /api/seatbooking/bookings/me` to fetch the bookings for the authenticated user.
  - [x] Create an API endpoint `DELETE /api/seatbooking/bookings/{id}` to cancel a booking.
  - [x] The delete endpoint should verify that the user attempting to cancel the booking is the one who created it.
  - [x] The endpoint should not allow the cancellation of bookings for past dates.

## Dev Notes

- **API Endpoints:**
  - `GET /api/seatbooking/bookings/me`
  - `DELETE /api/seatbooking/bookings/{id}`
- **Data Display:** The list of bookings should be clear and easy to read. Consider a card-based layout for each booking.
- **State Management:** The frontend will need to manage the state of the user's bookings and update it after a cancellation.
- **Relevant Files:**
  - `apps/swivel-portal/src/pages/MyBookings.tsx` (or similar)
  - `apps/swivel-portal-api/`

### Testing

- **Unit Tests:**
  - Test the backend logic for the delete endpoint, including ownership and date checks.
- **Integration Tests:**
  - Test the `GET /api/seatbooking/bookings/me` and `DELETE /api/seatbooking/bookings/{id}` endpoints.
- **E2E Tests:**
  - Simulate a user viewing their bookings and canceling one. Verify that the UI updates correctly.

## Change Log

| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-10-08 | 1.0 | Initial draft | Bob (SM) |
