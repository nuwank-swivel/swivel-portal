# Story 07.04: Admin Cancel Any Booking (Regular & Recurring)

- **Status**: Approved
- **Epic**: Booking Management

## Story

**As an** admin,
**I want** to be able to cancel any booking (regular or recurring occurrence) directly from the All Bookings page,
**so that** I can quickly resolve issues, free up seats, and manage bookings for all users as needed.

## Acceptance Criteria

1. Admins see a cancel action (button or icon) for each booking (regular or recurring) in the All Bookings page UI.
2. Clicking cancel prompts for confirmation before proceeding.
3. Upon confirmation, the booking (regular or recurring occurrence) is cancelled and removed from the list for the selected date.
4. The cancellation logic is identical for regular and recurring bookings; for recurring, only the selected occurrence is cancelled (not the entire series).
5. Cancelled bookings are not shown in the All Bookings list for that date.
6. The user whose booking was cancelled receives a notification (email or in-app) with the reason if provided.
7. The backend supports cancellation for both regular and recurring booking occurrences via a unified API endpoint.
8. Audit logs record who performed the cancellation and which booking was affected.

## Tasks / Subtasks

- [ ] **Frontend:**
  - [x] Add cancel action (button/icon) to each booking row in All Bookings page.
  - [x] Show confirmation dialog before cancelling.
  - [x] Remove cancelled booking from UI after success.
  - [ ] Trigger notification to affected user.
- [ ] **Backend:**
  - [x] Update booking API to support cancellation for both regular and recurring booking occurrences.
  - [ ] Ensure audit logging for admin actions.
  - [ ] Send notification to affected user.

## Dev Notes

- **Database:** Ensure bookings (regular and recurring occurrences) can be cancelled and tracked with audit logs.
- **API:** Unified endpoint for cancelling any booking occurrence by ID.
- **Relevant Files:**
  - `apps/swivel-portal/app/components/booking/AllBookingsPage.tsx`
  - `apps/swivel-portal-api/`
  - `libs/dal/`

### Testing

- **Unit Tests:**
  - Test cancel logic for regular and recurring bookings.
  - Test UI for cancel action and confirmation dialog.
- **Integration Tests:**
  - Test API endpoint for cancellation and audit logging.
  - Test notification delivery to affected user.

## Change Log

| Date       | Version | Description   | Author         |
| ---------- | ------- | ------------- | -------------- |
| 2025-10-30 | 0.1     | Initial draft | GitHub Copilot |
