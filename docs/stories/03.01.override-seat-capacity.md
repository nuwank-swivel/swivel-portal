# Story 03.01: Override Seat Capacity

- **Status**: Draft
- **Epic**: Admin Features

## Story

**As an** admin,
**I want** to modify the seat capacity for specific dates,
**so that** I can adjust for holidays, events, or other special circumstances.

## Acceptance Criteria

1. An admin can select a date and set a specific seat count for that day, overriding the default.
2. This override can be to increase or decrease the number of available seats.
3. The updated capacity is reflected in the availability check for that date.
4. Non-admin users cannot access this functionality.
5. The system stores a record of all date-specific overrides.

## Tasks / Subtasks

- [ ] **Frontend:**
  - [ ] Create an admin-only UI for managing date overrides. This could be part of the booking modal or a separate admin page.
  - [ ] The UI should allow the admin to select a date and input a new seat count.
  - [ ] The frontend should call the API to save the override.
- [ ] **Backend:**
  - [ ] Create an API endpoint `PUT /api/seatbooking/day-overrides/{date}` to create or update a seat capacity override for a specific date.
  - [ ] This endpoint must be protected and accessible only by admins.
  - [ ] The override data should be stored in the `daySeatOverrides` collection.
  - [ ] The availability calculation logic must be updated to use the override value if one exists for a given date.

## Dev Notes

- **API Endpoint:** `PUT /api/seatbooking/day-overrides/{date}`
- **Request Body:**
  ```json
  {
    "capacity": 25
  }
  ```
- **Database Collection:** `daySeatOverrides`
- **Authorization:** This is a critical admin feature and must be properly secured.
- **Relevant Files:**
  - `apps/swivel-portal/src/components/admin/CapacityManager.tsx` (or similar)
  - `apps/swivel-portal-api/`

### Testing

- **Integration Tests:**
  - Test the `PUT /api/seatbooking/day-overrides/{date}` endpoint, ensuring it's protected from non-admin access.
  - After setting an override, call the `GET /api/seatbooking/availability` endpoint for that date to verify that the new capacity is used in the calculation.
- **E2E Tests:**
  - Simulate an admin setting an override and then a regular user viewing the updated availability.

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-10-08 | 1.0     | Initial draft | Bob (SM) |
